name: CI/CD Pipeline

on:
  pull_request:
    types:
      - opened
      - edited
      - synchronize
      - reopened
  push:
    branches:
      - main

jobs:
  check-mr:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Check PR message
        uses: commitizen-tools/commitizen-action@master
        run: |
          PR_TITLE="${{ github.event.pull_request.title }}"
          cz check --message "$PR_TITLE"

  lint:
    runs-on: ubuntu-latest
    needs: check-mr  # This ensures the lint job only runs after the check-mr job
    continue-on-error: true  # Allow failure for linting job
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Install dependencies
        run: |
          npm install

      - name: Run Lint
        run: |
          npm run lint

  build:
    runs-on: ubuntu-latest
    needs: lint  # Ensure build runs after lint
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Install dependencies
        run: |
          npm install

      - name: Build project
        run: |
          npm run build
